osx_image: xcode6.4

language: objective-c
env:
  global:
    secure: gZMOaHQIeG7nplBCuH7EKf9o6Ez2rtoSskrv3nOTziSxFfZq322MrxvkidDpEN7AKWYQm27FO+tCzgq0slXb578lQ9P5ySDwEdExKtk/jMtKsBsf3cr4dzSMiqV5D5TbsH2jE9HQlpYUoJeoMBicR2XsTmd7wiu2jAzNBFqGfiY=

before_install:
  - gem update cocoapods --no-ri --no-rdoc
  - gem install xcpretty --no-ri --no-rdoc
  - ./ci_scripts/install_fauxpas.sh
script:
  - "./ci_scripts/check_fauxpas.sh"
  - "./ci_scripts/check_version.rb"
  - set -o pipefail && xcodebuild test -workspace Stripe.xcworkspace -scheme "StripeiOS Tests" -configuration Debug -sdk iphonesimulator -destination 'platform=iOS Simulator,name=iPhone 5s,OS=7.1' -destination 'platform=iOS Simulator,name=iPhone 5s,OS=8.4' | xcpretty -c
  - xctool test -workspace Stripe.xcworkspace -scheme "StripeOSX Tests"
  - xctool build -workspace Stripe.xcworkspace -scheme "Stripe iOS Example (Simple)" -sdk iphonesimulator
  - xctool build -workspace Stripe.xcworkspace -scheme "Stripe iOS Example (Custom)" -sdk iphonesimulator
  - xctool build -workspace Stripe.xcworkspace -scheme "Stripe OSX Example"
  - "./Tests/installation_tests/cocoapods/test.sh"
  - "./Tests/installation_tests/manual_installation/test.sh"
